{"version":3,"sources":["State.ts","Transition.ts"],"names":[],"mappings":"AAAA,IAAO,KAAK,CAuDX;AAvDD,WAAO,OAAK,EAAC,CAAC;IASb;QASC,YAAY,OAAY;YACvB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QACxB,CAAC;QAED,OAAO,CAAC,IAAY,EAAE,GAAG,IAAW;YACnC,IAAI,CAAC,GAAS,IAAI,CAAC,WAAY,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;YAC7C,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBACR,MAAM,CAAC,KAAK,CAAC;YACd,CAAC;YAED,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;QACjC,CAAC;QAEO,UAAU,CAAC,CAAc,EAAE,GAAG,IAAW;YAChD,IAAI,QAAe,CAAC;YAEpB,EAAE,CAAC,CAAC,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;gBAC3B,MAAM,CAAC,KAAK,CAAC;YACd,CAAC;YAED,EAAE,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;gBACb,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;gBAC1C,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;oBACf,IAAI,CAAC,IAAI,EAAE,CAAC;gBACb,CAAC;gBACD,IAAI,CAAC,OAAO,CAAO,IAAI,CAAC,WAAY,CAAC,SAAS,CAAC,GAAG,QAAQ,CAAC;gBAC3D,QAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;YACtB,CAAC;YAED,MAAM,CAAC,IAAI,CAAC;QACb,CAAC;QAEO,gBAAgB,CAAC,KAAgB;YACxC,IAAI,CAAC,GAAG,IAAI,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YAChC,MAAM,CAAC,CAAC,CAAC;QACV,CAAC;IACF,CAAC;IAzCO,eAAS,GAAW,OAAO,CAAC;IAJd,aAAK,QA6C1B,CAAA;AACF,CAAC,EAvDM,KAAK,KAAL,KAAK,QAuDX;AC9CA","file":"state.js","sourcesContent":["module state {\n\n\texport type StateCtor = { new (context: any): State };\n\n\texport interface IState {\n\t\tenter(...args: any[]): void;\n\t\texit?(...args: any[]): void;\n\t}\n\n\texport abstract class State implements IState {\n\t\tstatic events: TransitionMap;\n\n\t\tprotected context: any;\n\t\tstatic stateName: string = 'state';\n\n\t\tabstract enter(...args: any[]): void;\n\t\texit: (...args: any[]) => void;\n\n\t\tconstructor(context: any) {\n\t\t\tthis.context = context;\n\t\t}\n\n\t\ttrigger(type: string, ...args: any[]): boolean {\n\t\t\tvar t = (<any>this.constructor).events[type];\n\t\t\tif (!t) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn this.transition(t, args);\n\t\t}\n\n\t\tprivate transition(t: ITransition, ...args: any[]): boolean {\n\t\t\tvar newState: State;\n\n\t\t\tif (t.guard && !t.guard()) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (t.state) {\n\t\t\t\tnewState = this.instantiateState(t.state);\n\t\t\t\tif (this.exit) {\n\t\t\t\t\tthis.exit();\n\t\t\t\t}\n\t\t\t\tthis.context[(<any>this.constructor).stateName] = newState;\n\t\t\t\tnewState.enter(args);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\n\t\tprivate instantiateState(state: StateCtor): State {\n\t\t\tvar s = new state(this.context);\n\t\t\treturn s;\n\t\t}\n\t}\n}","module state {\n\n\texport interface ITransition {\n\t\tguard?: () => boolean;\n\t\taction?: () => void;\n\t\tstate?: StateCtor;\n\t}\n\n\texport type TransitionMap = {[index: string]: ITransition};\n}"],"sourceRoot":"/source/"}